# Secure Coding Instructions

This project follows secure coding practices based on the OWASP Top 10 (2021).

## Security Requirements

When writing or modifying code in this project, always consider:

### A01:2021 - Broken Access Control
- Always verify user authentication and authorization before accessing protected resources
- Use the `@login_required` decorator for protected routes
- Validate and sanitize all file paths to prevent path traversal

### A02:2021 - Cryptographic Failures
- Never store passwords in plaintext; always use secure hashing (werkzeug.security)
- Use cryptographically secure secret keys (secrets.token_hex)
- Never hardcode sensitive values; use environment variables

### A03:2021 - Injection
- Always use parameterized queries for database operations
- Never use f-strings or string concatenation in SQL queries
- Validate and sanitize all user input

### A04:2021 - Insecure Design
- Validate file uploads (type, size, content)
- Implement proper rate limiting for sensitive operations
- Use allowlists instead of denylists

### A05:2021 - Security Misconfiguration
- Never run with debug=True in production
- Keep dependencies updated
- Use secure defaults

### A07:2021 - Cross-Site Scripting (XSS)
- Use template engines that auto-escape output (Jinja2 does this by default)
- Set appropriate Content-Type headers for served files
- Validate and sanitize user input displayed back to users

## Code Review Checklist
- [ ] No SQL injection vulnerabilities
- [ ] Passwords are securely hashed
- [ ] File uploads are validated and sanitized
- [ ] Authentication is required for sensitive operations
- [ ] No hardcoded secrets
- [ ] Debug mode is controlled by environment variable
