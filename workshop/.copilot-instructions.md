# Secure Coding Instructions - PARANOID MODE ðŸ”’

Dieses Projekt implementiert Security Best Practices basierend auf OWASP Top 10 (2021).
**ALLE** Code-Ã„nderungen mÃ¼ssen diese Regeln befolgen!

## Implementierte SchutzmaÃŸnahmen

### A01:2021 - Broken Access Control âœ…
- `@login_required` Decorator fÃ¼r alle geschÃ¼tzten Routes
- CSRF-Token fÃ¼r alle POST-Requests
- Logout nur via POST (nicht GET!)
- Session-Regeneration bei Login (Session Fixation Prevention)
- Path Traversal Schutz mit mehrfachen Validierungsschichten
- Symlink-PrÃ¼fung bei Datei-Operationen

### A02:2021 - Cryptographic Failures âœ…
- PasswÃ¶rter mit PBKDF2-SHA256 gehasht (600k Iterationen)
- Secret Key aus Umgebungsvariable oder `secrets.token_hex(32)`
- Keine hartcodierten Secrets im Code

### A03:2021 - Injection âœ…
- Alle SQL-Queries sind parameterisiert (Prepared Statements)
- Input-Validierung mit strikten Whitelists
- Filename-Sanitization gegen Command Injection

### A04:2021 - Insecure Design âœ…
- File Upload: Extension-Allowlist + Magic Bytes Validierung
- Vibe-Auswahl: Strenge Allowlist, kein freier Text
- Rate-Limiting gegen Brute-Force
- Size-Limits gegen DoS

### A05:2021 - Security Misconfiguration âœ…
- Debug-Mode Ã¼ber Umgebungsvariable gesteuert
- Security Headers (CSP, X-Frame-Options, etc.)
- Keine Fehlermeldungen mit Stack Traces

### A07:2021 - Identification and Authentication Failures âœ…
- Timing-Attack-resistenter Login (Dummy-Hash-Vergleich)
- Rate-Limiting (5 Versuche, dann 5 Min Sperre)
- Session-Timeout (1 Stunde)
- Sichere Cookie-Flags (HttpOnly, Secure, SameSite)

### A09:2021 - Security Logging and Monitoring Failures âœ…
- Generische Error-Pages (keine Interna leaken)
- Security-Events werden geloggt (Login-Erfolge, Fehler)

## Code-Review Checkliste

- [ ] SQL-Queries: Parameterisiert? Keine String-Konkatenation?
- [ ] User-Input: Validiert vor Verwendung?
- [ ] POST-Routes: CSRF-Token validiert?
- [ ] File-Operationen: Path Traversal geprÃ¼ft?
- [ ] Authentifizierung: `@login_required` wo nÃ¶tig?
- [ ] Fehlerbehandlung: Keine sensiblen Infos leaken?
- [ ] Logging: Keine PasswÃ¶rter/Tokens loggen?

## Security Headers (automatisch gesetzt)

```
X-Frame-Options: DENY
X-XSS-Protection: 1; mode=block
X-Content-Type-Options: nosniff
Referrer-Policy: strict-origin-when-cross-origin
Content-Security-Policy: default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'
Permissions-Policy: geolocation=(), microphone=(), camera=()
```

## Environment Variables

```bash
FLASK_SECRET_KEY=<mindestens-32-bytes-hex>  # PFLICHT in Production!
FLASK_DEBUG=false                            # NIEMALS true in Production!
```
