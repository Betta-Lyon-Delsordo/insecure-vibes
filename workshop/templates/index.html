<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Secure Vibes Demo</title>
  </head>
  <body style="background-color:powderblue;">
    <h1>Welcome to Secure Vibes</h1>
    <!-- Jinja2 escaped automatisch - XSS-Schutz -->
    <p>Logged in as: <strong>{{ username or 'Guest' }}</strong></p>

    <ul>
      <!-- initdb nur fÃ¼r Admins sichtbar machen -->
      {% if username == 'admin' %}
      <li><a href="/initdb">Initialize demo database (Admin only)</a></li>
      {% endif %}
      <li>
        <form action="/search" method="get">
          <!-- [Input-Validierung] maxlength clientseitig -->
          <label>Search users: <input type="text" name="q" maxlength="50"></label>
          <button type="submit">Search</button>
        </form>
      </li>
      {% if not username %}
      <li><a href="/login">Login</a></li>
      {% else %}
      <!-- [OWASP A01:2021] Logout als POST mit CSRF-Token -->
      <li>
        <form action="/logout" method="post" style="display:inline;">
          <input type="hidden" name="_csrf_token" value="{{ csrf_token() }}">
          <button type="submit" style="background:none;border:none;color:blue;text-decoration:underline;cursor:pointer;">Logout</button>
        </form>
      </li>
      {% endif %}
      <li><a href="/upload">Upload a file</a></li>
      <li><a href="/vibes">ðŸŽ­ Vibe Checker</a></li>
      <!-- Secret page erfordert jetzt Login -->
    </ul>
  </body>
</html>